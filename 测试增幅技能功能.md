# 测试增幅技能功能指南

## 快速测试步骤

### 1. 重启后端服务

```bash
# 停止当前后端服务（如果正在运行）
# 然后重新启动
python start-backend.bat
```

或者使用重启脚本：
```bash
restart_flask.bat
```

### 2. 登录测试账号

- **账号**: test50_97355
- **密码**: 123456
- **用户ID**: 100006

### 3. 查看幻兽当前属性

1. 进入幻兽栏
2. 选择一只幻兽查看详情
3. **记录打书前的属性值**（特别是物攻/法攻/物防/法防/速度/气血）

### 4. 准备技能书

确保测试账号有增幅技能书，例如：
- 强力技能书（物攻+9%）
- 高级强力技能书（物攻+18%）
- 防御技能书（物防+5%）
- 敏捷技能书（速度+10%）
- 体魄技能书（气血+10%）

如果没有，可以通过商城购买或使用管理脚本添加。

### 5. 使用技能书打书

1. 在幻兽详情页面点击"打书"按钮
2. 选择一本增幅技能书（例如：强力）
3. 确认使用

### 6. 验证属性变化

打书成功后，刷新幻兽详情页面，检查：

1. **技能列表**: 应该包含新学会的增幅技能
2. **属性值**: 对应属性应该增加
3. **战力**: 应该相应增加

### 7. 计算预期增加值

**公式**: 增加值 = 裸属性 × 增幅百分比

**示例**:
- 幻兽物攻裸数值: 200
- 打上强力技能（+9%）
- 预期增加: 200 × 9% = 18
- 最终物攻: 218

**注意**: 裸属性是指不含魔魂、战骨、战灵加成的基础属性。

## 测试用例

### 用例1: 物攻型幻兽打强力书

**前置条件**:
- 幻兽: 烈焰神龙（物攻型）
- 物攻裸数值: 假设为 500

**操作**:
1. 使用强力技能书

**预期结果**:
- 学会技能: 强力
- 物攻增加: 500 × 9% = 45
- 最终物攻: 545
- 战力增加

### 用例2: 法攻型幻兽打智慧书

**前置条件**:
- 幻兽: 冰霜凤凰（法攻型）
- 法攻裸数值: 假设为 480

**操作**:
1. 使用智慧技能书

**预期结果**:
- 学会技能: 智慧
- 法攻增加: 480 × 9% = 43
- 最终法攻: 523
- 战力增加

### 用例3: 多个增幅技能叠加

**前置条件**:
- 幻兽: 雷霆麒麟
- 物攻裸数值: 450
- 物防裸数值: 300
- 速度裸数值: 60

**操作**:
1. 使用强力技能书（+9%物攻）
2. 使用防御技能书（+5%物防）
3. 使用敏捷技能书（+10%速度）

**预期结果**:
- 学会技能: 强力、防御、敏捷
- 物攻: 450 → 490 (+40)
- 物防: 300 → 315 (+15)
- 速度: 60 → 66 (+6)
- 战力显著增加

### 用例4: 高级增幅技能

**前置条件**:
- 幻兽: 任意物攻型
- 物攻裸数值: 400

**操作**:
1. 使用高级强力技能书（+18%物攻）

**预期结果**:
- 学会技能: 高级强力
- 物攻增加: 400 × 18% = 72
- 最终物攻: 472
- 战力增加

## 常见问题

### Q1: 打书后属性没有变化？

**可能原因**:
1. 后端服务没有重启
2. 前端页面没有刷新
3. 打的不是增幅技能书（可能是主动技能或被动技能）

**解决方法**:
1. 重启后端服务
2. 强制刷新浏览器（Ctrl+F5）
3. 确认使用的是增幅技能书

### Q2: 属性增加的数值不对？

**可能原因**:
1. 计算时使用了包含装备加成的属性，而不是裸属性
2. 四舍五入导致的微小差异

**解决方法**:
1. 确认使用裸属性计算（卸下魔魂、战骨、战灵后的属性）
2. 允许1-2点的误差（四舍五入）

### Q3: 如何查看裸属性？

**方法**:
1. 卸下幻兽的所有魔魂、战骨、战灵
2. 查看此时的属性值
3. 这就是裸属性

或者：
1. 查看幻兽详情页面的基础属性
2. 减去装备加成部分

### Q4: 多个增幅技能如何叠加？

**叠加规则**:
- 同类型增幅技能的加成百分比直接相加
- 例如: 强力(+9%) + 高级强力(+18%) = +27%物攻

**注意**:
- 通常一只幻兽最多4个技能
- 需要合理搭配增幅技能和其他技能

## 验证清单

- [ ] 后端服务已重启
- [ ] 测试账号可以正常登录
- [ ] 测试账号有增幅技能书
- [ ] 打书前记录了幻兽属性
- [ ] 打书成功，技能列表已更新
- [ ] 刷新页面后属性已增加
- [ ] 属性增加值符合预期（允许1-2点误差）
- [ ] 战力已相应增加
- [ ] 多个增幅技能可以叠加

## 自动化测试

运行测试脚本验证功能：

```bash
python test_skill_amplification.py
```

测试脚本会验证：
- ✅ 增幅技能配置正确加载
- ✅ 强力技能加成计算正确
- ✅ 高级强力技能加成计算正确
- ✅ 多个增幅技能可以叠加
- ✅ 所有12种增幅技能配置正确

## 测试完成标准

功能测试通过的标准：
1. 打书成功后，技能列表包含新技能
2. 对应属性增加了正确的百分比
3. 战力相应增加
4. 多个增幅技能可以叠加
5. 前端显示正确

## 联系支持

如果测试过程中遇到问题，请提供：
1. 测试账号信息
2. 幻兽ID和名称
3. 使用的技能书
4. 打书前后的属性截图
5. 浏览器控制台的错误信息（如有）
