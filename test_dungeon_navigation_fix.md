# 副本导航白屏修复测试指南

## 测试环境准备

1. 确保前后端服务已启动
2. 打开浏览器开发者工具（F12）
3. 切换到 Console 标签
4. 登录游戏账号

## 测试用例

### 测试用例 1：副本挑战页 → 返回首页

**步骤**：
1. 进入任意副本挑战页面（例如：森林入口）
2. 点击页面底部的"返回游戏首页"链接
3. 观察页面是否正常跳转到首页

**预期结果**：
- ✅ 页面正常跳转到首页
- ✅ 控制台显示：`[DungeonChallenge] 导航到首页`
- ✅ 无白屏现象
- ✅ 无错误提示

**如果失败**：
- ❌ 页面白屏 → 检查控制台错误日志
- ❌ 显示 alert 错误提示 → 记录错误信息
- ❌ 控制台显示路由错误 → 检查路由配置

---

### 测试用例 2：副本挑战页 → 返回地图

**步骤**：
1. 进入任意副本挑战页面
2. 点击"返回地图首页"链接
3. 观察页面是否正常跳转到地图页

**预期结果**：
- ✅ 页面正常跳转到地图页
- ✅ 控制台显示：`[DungeonChallenge] 导航到地图`
- ✅ 地图页正常显示当前位置和副本列表
- ✅ 无白屏现象

---

### 测试用例 3：副本挑战页 → 挑战幻兽 → 战斗结果页

**步骤**：
1. 进入副本挑战页面
2. 点击"前进"按钮，掷骰子
3. 遇到幻兽后，点击"挑战幻兽"
4. 观察是否正常跳转到战斗结果页

**预期结果**：
- ✅ 页面正常跳转到战斗结果页
- ✅ 控制台显示：`[DungeonChallenge] 挑战成功，导航到战斗结果页`
- ✅ 战斗结果页正常显示战斗数据
- ✅ 无白屏现象

**如果失败**：
- ❌ 页面白屏 → 检查控制台是否有 `导航到战斗结果页失败` 错误
- ❌ 显示 alert "跳转失败" → 记录具体错误信息

---

### 测试用例 4：战斗结果页 → 返回副本

**步骤**：
1. 完成一次副本挑战（胜利或失败）
2. 在战斗结果页点击"返回副本"
3. 观察是否正常返回副本挑战页

**预期结果**：
- ✅ 页面正常返回副本挑战页
- ✅ 控制台显示：`[DungeonBattleResult] 导航回副本页`
- ✅ 副本页显示当前进度
- ✅ 无白屏现象

---

### 测试用例 5：战斗结果页 → 返回地图

**步骤**：
1. 在战斗结果页点击"返回地图首页"
2. 观察是否正常跳转到地图页

**预期结果**：
- ✅ 页面正常跳转到地图页
- ✅ 控制台显示：`[DungeonBattleResult] 导航到地图`
- ✅ 无白屏现象

---

### 测试用例 6：战斗结果页 → 返回游戏首页

**步骤**：
1. 在战斗结果页点击"返回游戏首页"
2. 观察是否正常跳转到首页

**预期结果**：
- ✅ 页面正常跳转到首页
- ✅ 控制台显示：`[DungeonBattleResult] 导航到首页`
- ✅ 无白屏现象

---

### 测试用例 7：连续快速点击测试

**步骤**：
1. 进入副本挑战页面
2. 快速连续点击"返回游戏首页"按钮 3-5 次
3. 观察页面反应

**预期结果**：
- ✅ 页面正常跳转到首页（只跳转一次）
- ✅ 无白屏现象
- ✅ 无多次 alert 提示
- ✅ 控制台可能显示多次导航日志（正常）

---

### 测试用例 8：刷新页面后导航

**步骤**：
1. 进入副本挑战页面
2. 按 F5 刷新页面
3. 等待页面加载完成
4. 点击"返回游戏首页"

**预期结果**：
- ✅ 页面正常跳转到首页
- ✅ 无白屏现象
- ✅ 刷新后状态正常恢复

---

## 控制台日志检查清单

### 正常导航日志示例

```
[DungeonChallenge] 导航到首页
[DungeonChallenge] 导航到地图
[DungeonChallenge] 挑战成功，导航到战斗结果页
[DungeonBattleResult] 导航回副本页
[DungeonBattleResult] 导航到地图
[DungeonBattleResult] 导航到首页
```

### 错误日志示例（如果出现）

```
[DungeonChallenge] 导航到首页失败: NavigationDuplicated
路由导航错误: Error: ...
```

## 常见问题排查

### 问题 1：仍然出现白屏

**可能原因**：
1. 前端代码未重新编译
2. 浏览器缓存未清除
3. 目标页面组件有错误

**解决方法**：
```bash
# 1. 重启前端服务
# 停止当前前端进程，然后重新启动
npm run dev

# 2. 清除浏览器缓存
# Chrome: Ctrl+Shift+Delete → 清除缓存
# 或者使用无痕模式测试

# 3. 检查目标页面组件
# 查看 MainPage.vue 和 MapPage.vue 是否有错误
```

### 问题 2：显示"页面跳转失败"提示

**可能原因**：
1. 路由配置错误
2. 组件加载失败
3. 权限验证失败

**解决方法**：
1. 检查控制台完整错误信息
2. 检查 router/index.js 中的路由配置
3. 检查 router.beforeEach 导航守卫

### 问题 3：控制台没有日志输出

**可能原因**：
1. 代码未生效（未重新编译）
2. 控制台日志被过滤

**解决方法**：
1. 确认前端服务已重启
2. 检查控制台过滤器设置
3. 尝试在浏览器中手动输入 `console.log('test')`

## 性能测试

### 导航响应时间

测试每个导航操作的响应时间：

| 操作 | 预期时间 | 实际时间 | 状态 |
|------|---------|---------|------|
| 副本页 → 首页 | < 500ms | ___ ms | ⬜ |
| 副本页 → 地图 | < 500ms | ___ ms | ⬜ |
| 副本页 → 战斗结果 | < 1000ms | ___ ms | ⬜ |
| 战斗结果 → 副本页 | < 500ms | ___ ms | ⬜ |
| 战斗结果 → 首页 | < 500ms | ___ ms | ⬜ |
| 战斗结果 → 地图 | < 500ms | ___ ms | ⬜ |

## 测试报告模板

```
测试日期：____年__月__日
测试人员：________
浏览器：Chrome / Firefox / Safari / Edge
版本：________

测试结果：
- 测试用例 1：✅ / ❌
- 测试用例 2：✅ / ❌
- 测试用例 3：✅ / ❌
- 测试用例 4：✅ / ❌
- 测试用例 5：✅ / ❌
- 测试用例 6：✅ / ❌
- 测试用例 7：✅ / ❌
- 测试用例 8：✅ / ❌

发现的问题：
1. _______________
2. _______________

备注：
_______________
```

## 回归测试

修复完成后，建议进行以下回归测试：

1. ✅ 其他页面的导航是否正常
2. ✅ 副本的其他功能是否正常（前进、迷踪、重置等）
3. ✅ 战斗系统是否正常
4. ✅ 数据保存是否正常
5. ✅ 移动端浏览器是否正常

## 总结

完成所有测试用例后：
- 如果全部通过 → 修复成功 ✅
- 如果部分失败 → 记录失败用例，继续排查 ⚠️
- 如果全部失败 → 检查代码是否生效，重新部署 ❌
