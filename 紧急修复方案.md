# 紧急修复方案

## 问题
代码已更新，但Flask没有重新加载，API响应中仍然没有 `total_contribution` 字段。

## 立即执行

### 方案A: 强制Flask重新加载（最快）

1. **在 `interfaces/routes/alliance_routes.py` 文件中**
   - 找到第64行：`# 版本标记：2026-01-20-fix-total-contribution-v2`
   - 在这行后面添加一个空格，然后删除这个空格（触发文件修改）
   - 保存文件（Ctrl+S）

2. **查看PowerShell窗口**
   - 应该看到：`* Detected change in ... reloading`
   - 等待重载完成

3. **测试API**
   - 刷新浏览器页面
   - 检查响应

### 方案B: 完全重启（最可靠）

1. **停止Flask服务**
   - 在PowerShell中按 `Ctrl+C`
   - 等待完全停止

2. **清除缓存**
   ```powershell
   Get-ChildItem -Path interfaces -Recurse -Filter __pycache__ | Remove-Item -Recurse -Force
   ```

3. **重新启动**
   ```powershell
   python -m interfaces.web_api.app
   ```

4. **等待启动完成**
   - 看到 `* Running on http://127.0.0.1:5000`

5. **测试API**
   - 刷新浏览器页面（Ctrl+F5）
   - 检查 `/api/alliance/my` 响应

## 验证

API响应应该包含：
```json
{
  "member_info": {
    "contribution": 10,
    "role": 1,
    "total_contribution": 15  // ← 这个字段必须存在！
  }
}
```

## 如果仍然没有

请提供：
1. PowerShell窗口的完整输出（包括错误信息）
2. 浏览器Network标签中 `/api/alliance/my` 的完整响应
